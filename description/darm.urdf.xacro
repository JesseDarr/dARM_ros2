<?xml version="1.0" ?>
<robot name="darm_ros2" xmlns:xacro="http://www.ros.org/wiki/xacro">

<xacro:include filename="$(find darm_ros2)/description/materials.xacro" />
<xacro:include filename="$(find darm_ros2)/description/darm.trans" />
<xacro:include filename="$(find darm_ros2)/description/ros2_control.xacro" />

    <!-- LINKS -->
	<link name="world" />

    <link name="base_link">
        <inertial>
            <origin xyz="-2.288387567127362e-09 0.029744552569164286 -2.7790617352941843e-11" rpy="0 0 0"/>
            <mass value="30.98237928008998" />
            <inertia ixx="0.338536" iyy="0.636909" izz="0.338536" ixy="0" iyz="0" ixz="0"/>
        </inertial>
        <visual name="base_link_visual">
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/base_link.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="orange"/>
        </visual>
        <collision name="base_link_collision">
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/base_link.stl" scale="0.001 0.001 0.001" />
            </geometry>
        </collision>
    </link>

    <link name="joint_1">
        <inertial>
            <origin xyz="1.0412391360122205e-08 0.05843841045185916 -1.8359150331439202e-08" rpy="0 0 0"/>
            <mass value="7.29719957969873" />
            <inertia ixx="0.017367" iyy="0.039634" izz="0.043633" ixy="0" iyz="0" ixz="0"/>
        </inertial>
        <visual name="joint_1_visual">
            <origin xyz="0 -0.14444 0" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/joint_1.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="orange"/>
        </visual>
        <collision name="joint_1_collision">
            <origin xyz="0 -0.14444 0" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/joint_1.stl" scale="0.001 0.001 0.001" />
            </geometry>
        </collision>
    </link>

    <link name="joint_2">
        <inertial>
            <origin xyz="-0.030999990292829665 -0.03967100307703755 -0.09345902693201741" rpy="0 0 0"/>
            <mass value="4.705409447021641" />
            <inertia ixx="0.021968" iyy="0.021644" izz="0.01127" ixy="0" iyz="-0.005371" ixz="0"/>
        </inertial>
        <visual name="joint_2_visual">
            <origin xyz="-0.031 -0.21544 0" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/joint_2.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="orange"/>
        </visual>
        <collision name="joint_2_collision">
            <origin xyz="-0.031 -0.21544 0" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/joint_2.stl" scale="0.001 0.001 0.001" />
            </geometry>
        </collision>
    </link>

    <link name="joint_3">
        <inertial>
            <origin xyz="0.0026788974971455855 -0.02202458197490921 -0.051886883366897646" rpy="0 0 0"/>
            <mass value="2.2605790149546157"/>
            <inertia ixx="0.005583" iyy="0.004574" izz="0.003971" ixy="5e-06" iyz="-0.000312" ixz="1.2e-05"/>
        </inertial>
        <visual name="joint_3_visual">
            <origin xyz="0 -0.14056 0.176406" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/joint_3.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="orange"/>
        </visual>
        <collision name="joint_3_collision">
            <origin xyz="0 -0.14056 0.176406" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/joint_3.stl" scale="0.001 0.001 0.001" />
            </geometry>
        </collision>
    </link>

    <link name="forearm">
        <inertial>
            <origin xyz="0.02528030466435227 0.21375986046964401 -0.3971554112886445" rpy="0 0 0"/>
            <mass value="5.700507286017294"/>
            <inertia ixx="0.047425" iyy="0.015946" izz="0.055888" ixy="-0.006733" iyz="-0.00719" ixz="-0.001175"/>
        </inertial>
        <visual name="forearm_visual">
            <origin xyz="0.0364 -0.037163 -0.184611" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/forearm.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="orange"/>
        </visual>
        <collision name="forearm_collision">
            <origin xyz="0.0364 -0.037163 -0.184611" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/forearm.stl" scale="0.001 0.001 0.001" />
            </geometry>
        </collision>
    </link>

    <link name="differential">
        <inertial>
            <origin xyz="-0.05277600000006376 0.000633380149369922 0.00011039636426521393" rpy="0 0 0"/>
            <mass value="0.9802336095389897"/>
            <inertia ixx="0.000268" iyy="0.001136" izz="0.001153" ixy="0" iyz="-3e-06" ixz="0"/>
        </inertial>
        <visual name="differential_visual">
            <origin xyz="-0.052776 -0.447953 0.178157" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/differential.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="orange"/>
        </visual>
        <collision name="differential_collision">
            <origin xyz="-0.052776 -0.447953 0.178157" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/differential.stl" scale="0.001 0.001 0.001" />
            </geometry>
        </collision>
    </link>

    <link name="gripper">
        <inertial>
            <origin xyz="-7.247867905438169e-10 0.04632630127802684 0.008084972048104627" rpy="0 0 0"/>
            <mass value="1.788490804033633"/>
            <inertia ixx="0.001472" iyy="0.001433" izz="0.001772" ixy="0" iyz="-6.1e-05" ixz="0"/>
        </inertial>
        <visual name="gripper_visual">
            <origin xyz="0 -0.46933 0.174426" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/gripper.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="orange"/>
        </visual>
        <collision name="gripper_collision">
            <origin xyz="0 -0.46933 0.174426" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/gripper.stl" scale="0.001 0.001 0.001" />
            </geometry>
        </collision>
    </link>

    <link name="finger_1">
        <inertial>
            <origin xyz="0.00928504927481494 0.02269408525715566 -0.0004692868979557785" rpy="0 0 0"/>
            <mass value="0.26185795930929495"/>
            <inertia ixx="8.5e-05" iyy="4.2e-05" izz="8.9e-05" ixy="-1e-06" iyz="-1.5e-05" ixz="-3e-06"/>
        </inertial>
        <visual name="finger_1_visual">
            <origin xyz="0 -0.552427 0.156371" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/finger_1.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="rubber"/>
        </visual>
        <collision name="finger_1_collision">
            <origin xyz="0 -0.552427 0.156371" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/finger_1.stl" scale="0.001 0.001 0.001" />
            </geometry>
        </collision>
    </link>

    <link name="finger_2">
        <inertial>
            <origin xyz="-0.00928504927490067 0.0211928338014451 0.008128885220845206" rpy="0 0 0"/>
            <mass value="0.2618579593092649"/>
            <inertia ixx="8.5e-05" iyy="3.8e-05" izz="9.3e-05" ixy="2e-06" iyz="-4e-06" ixz="-3e-06"/>
        </inertial>
        <visual name="finger_2_visual">
            <origin xyz="0 -0.553631 0.163266" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/finger_2.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="rubber"/>
        </visual>
        <collision name="finger_2_collision">
            <origin xyz="0 -0.553631 0.163266" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://darm_ros2/meshes/finger_2.stl" scale="0.001 0.001 0.001" />
            </geometry>
        </collision>
    </link>

    <link name="dock">
        <inertial>
            <origin xyz="9.123968339512894e-08 0.02244543692492791 -0.21216314201498515" rpy="0 0 0" />
            <mass value="4.14283366579888" />
            <inertia ixx="0.003902882548391967" iyy="0.00782818367286213" izz="0.006179527994280975" ixy="-2.754251235646076e-09" iyz="0.00017015521062901904" ixz="6.810558796533437e-09" />
        </inertial>
        <visual name="dock_visual">
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://darm_ros2/meshes/dock.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="rubber"/>
        </visual>
        <collision name="dock_collision">
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://darm_ros2/meshes/dock.stl" scale="0.001 0.001 0.001" />
            </geometry>
        </collision>
    </link>

    <!-- JOINTS -->
    <joint name="base_joint" type="fixed">
        <origin xyz="0 0 0" rpy="${90 * pi / 180} 0 ${180 * pi / 180}"/>
        <parent link="world"/>
        <child link="base_link"/>        
    </joint>

    <joint name="joint_1_joint" type="revolute">
        <origin xyz="0 0.14444 0" rpy="0 0 0"/>
        <parent link="base_link" />
        <child link="joint_1" />
        <axis xyz="0 1.0 0"/>
        <limit lower="${-pi}" upper="${pi}" effort="20" velocity="2" />
        <dynamics friction="0.2" />
    </joint>

    <joint name="joint_2_joint" type="revolute">
        <origin xyz="0.031 0.071 0" rpy="0 0 0"/>
        <parent link="joint_1" />
        <child link="joint_2" />
        <axis xyz="-1.0 0 0"/>
        <limit lower="-0.001" upper="${226 * pi / 180}" effort="40" velocity="2" />
        <dynamics friction="0.2" />
    </joint>

    <joint name="joint_3_joint" type="revolute">
        <origin xyz="-0.031 -0.07488 -0.176406" rpy="0 0 0"/>
        <parent link="joint_2" />
        <child link="joint_3" />
        <axis xyz="0 -0.390731 -0.920505"/>
        <limit lower="${-pi}" upper="${pi}" effort="20" velocity="2" />
        <dynamics friction="0.2" />
    </joint>

    <joint name="forearm_joint" type="revolute">
        <origin xyz="-0.0364 -0.103397 0.361017" rpy="0 0 0"/>
        <parent link="joint_3" />
        <child link="forearm" />
        <axis xyz="-1.0 0 0"/>
        <limit lower="-0.001" upper="${122.9 * pi / 180}" effort="20" velocity="2" />
        <dynamics friction="0.2" />
    </joint>

    <joint name="differential_joint" type="revolute">
        <origin xyz="0.089176 0.41079 -0.362768" rpy="0 0 0"/>
        <parent link="forearm" />
        <child link="differential" />
        <axis xyz="-1.0 0 0"/>
        <limit lower="${-110 * pi / 180}" upper="${110 * pi / 180}" effort="8" velocity="2" />
        <dynamics friction="0.2" />
    </joint>

    <joint name="gripper_joint" type="revolute">
        <origin xyz="-0.052776 0.021377 0.003731" rpy="0 0 0"/>
        <parent link="differential" />
        <child link="gripper" />
        <axis xyz="0 -0.985109 -0.171929"/>
        <limit lower="-3.141593" upper="3.141593" effort="8" velocity="2" />
        <dynamics friction="0.2" />
    </joint>

    <joint name="finger_1_joint" type="prismatic">
        <origin xyz="0 0.083097 0.018055" rpy="0 0 0"/>
        <parent link="gripper" />
        <child link="finger_1" />
        <axis xyz="1.0 0 0"/>
        <limit lower="-0.001" upper="0.025" effort="2" velocity="0.5" />
        <dynamics friction="0.1" />
    </joint>

    <joint name="finger_2_joint" type="prismatic">
        <origin xyz="0 0.084301 0.01116" rpy="0 0 0"/>
        <parent link="gripper" />
        <child link="finger_2" />
        <axis xyz="-1.0 0 0"/>
        <limit lower="-0.001" upper="0.025" effort="2" velocity="0.5" />
        <dynamics friction="0.1" />
    </joint>

    <joint name="dock_joint" type="fixed">
		<origin xyz="0 0 0" rpy="0 0 0"/>
		<parent link="base_link"/>
		<child link="dock"/>
	</joint>

    <!-- Plugins -->
    <gazebo>
        <plugin name="gz::sim::systems::JointStatePublisher" filename="gz-sim-joint-state-publisher-system"/>
    </gazebo>

</robot>